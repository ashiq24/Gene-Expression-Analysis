# -*- coding: utf-8 -*-
"""
Spyder Editor

This is a temporary script file.
"""
import numpy as np
from random import shuffle
filename='prostata.tab'
with open(filename) as f:
    lines=f.read().splitlines()
    lines=lines[3:]
    shuffle(lines)
    shuffle(lines)
    shuffle(lines)
    shuffle(lines)
    shuffle(lines)
    lines=[ i.split('\t') for i in lines]
    categories=[i[0] for i in lines]
    lines=[i[1:] for i in lines]
    lines=[[float(j) for j in i] for i in lines]
for i in range(len(lines[0])):
    base=0
    for j in range(len(lines)):
        if(base>lines[j][i]):
            base=lines[j][i]
    base=base*-1
    for j in range(len(lines)):
        lines[j][i]+=base
for i in range(len(lines[0])):
    base=1
    for j in range(len(lines)):
        if(base<lines[j][i]):
            base=lines[j][i]
    for j in range(len(lines)):
        lines[j][i]/=base
Tenfold=0
for i in range(0,10,1):
	print("Testing ------------>")
	lines=lines[90:102]+lines[0:90]
	categories=categories[90:102]+categories[0:90]

	Y=[]
	for i in categories:
	    if i=='normal':
		Y.append(0)
	    else :
		Y.append(1)

	from sklearn.feature_selection import SelectKBest
	from sklearn.feature_selection import chi2,f_classif, mutual_info_classif
	f=SelectKBest(chi2, k=1500)
	xlines = f.fit_transform(lines[0:90], Y[0:90])
	mast=f.get_support()

	feachers=[]
	i=0
	for bool in mast:
	    if bool:
		feachers.append(i)
	    i+=1

	from keras.utils import np_utils
	Y=np_utils.to_categorical(Y)
	X=np.array(xlines)
	print(len(xlines[0]))

	from keras.models import Sequential
	from keras.layers import Dense
	from keras.layers import Dropout ,ActivityRegularization,LeakyReLU
	from keras.regularizers import l1_l2,l1

	model = Sequential()
	model.add(Dense(2000, activation='linear',W_regularizer=l1(.001),input_shape=(1500,)))
	model.add(LeakyReLU(alpha=.001))
	#model.add(ActivityRegularization(l2=0.001))
	model.add(Dense(1000, activation='linear',W_regularizer=l1(.001)))
	model.add(LeakyReLU(alpha=.001))
	#model.add(ActivityRegularization(l2=0.001))
	#model.add(Dense(800, activation='elu'))
	#model.add(ActivityRegularization(l2=0.01))
	#model.add(Dense(500, activation='elu'))
	#model.add(Dense(100, activation='elu'))
	#model.add(Dense(100, activation='elu'))
	#model.add(Dense(100, activation='elu'))
	model.add(Dense(2, activation='softmax'))
	model.compile(optimizer='adam',
		      loss='categorical_crossentropy',
		      metrics=['accuracy'])
	#model.summary()

	model.fit(X,Y[0:90],epochs=17)


	testx=[]
	for j in range(90,102,1):
	    m=[lines[j][i] for i in feachers]
	    testx.append(m)

	testx=np.array(testx)

	score = model.evaluate(testx,Y[90:] ,verbose=0)
	print('Test loss:', score[0])
	print('Test accuracy:', score[1])
	Tenfold+=score[1]
print Tenfold

'''
Testing ------------>
Using TensorFlow backend.
1500
Epoch 1/17
2017-11-16 23:24:16.589919: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-16 23:24:16.589961: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-16 23:24:16.589980: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
90/90 [==============================] - 0s - loss: 2.8016 - acc: 0.5778
Epoch 2/17
90/90 [==============================] - 0s - loss: 0.6781 - acc: 0.8222
Epoch 3/17
90/90 [==============================] - 0s - loss: 0.6326 - acc: 0.8333
Epoch 4/17
90/90 [==============================] - 0s - loss: 0.5558 - acc: 0.8889
Epoch 5/17
90/90 [==============================] - 0s - loss: 0.4840 - acc: 0.9111
Epoch 6/17
90/90 [==============================] - 0s - loss: 0.4650 - acc: 0.8889
Epoch 7/17
90/90 [==============================] - 0s - loss: 0.4582 - acc: 0.8222
Epoch 8/17
90/90 [==============================] - 0s - loss: 0.3941 - acc: 0.9333
Epoch 9/17
90/90 [==============================] - 0s - loss: 0.3623 - acc: 0.9222
Epoch 10/17
90/90 [==============================] - 0s - loss: 0.3637 - acc: 0.9222
Epoch 11/17
90/90 [==============================] - 0s - loss: 0.3508 - acc: 0.9111
Epoch 12/17
90/90 [==============================] - 0s - loss: 0.3306 - acc: 0.9667
Epoch 13/17
90/90 [==============================] - 0s - loss: 0.2626 - acc: 0.9667
Epoch 14/17
90/90 [==============================] - 0s - loss: 0.2621 - acc: 0.9667
Epoch 15/17
90/90 [==============================] - 0s - loss: 0.2407 - acc: 0.9667
Epoch 16/17
90/90 [==============================] - 0s - loss: 0.2285 - acc: 0.9778
Epoch 17/17
90/90 [==============================] - 0s - loss: 0.2134 - acc: 0.9778
('Test loss:', 0.23051679134368896)
('Test accuracy:', 1.0)
Testing ------------>
1500
Epoch 1/17
90/90 [==============================] - 0s - loss: 3.1017 - acc: 0.7000
Epoch 2/17
90/90 [==============================] - 0s - loss: 0.6416 - acc: 0.8889
Epoch 3/17
90/90 [==============================] - 0s - loss: 0.5575 - acc: 0.8889
Epoch 4/17
90/90 [==============================] - 0s - loss: 0.4789 - acc: 0.9333
Epoch 5/17
90/90 [==============================] - 0s - loss: 0.4125 - acc: 0.9222
Epoch 6/17
90/90 [==============================] - 0s - loss: 0.3442 - acc: 0.9556
Epoch 7/17
90/90 [==============================] - 0s - loss: 0.3156 - acc: 0.9556
Epoch 8/17
90/90 [==============================] - 0s - loss: 0.2804 - acc: 0.9778
Epoch 9/17
90/90 [==============================] - 0s - loss: 0.2510 - acc: 0.9778
Epoch 10/17
90/90 [==============================] - 0s - loss: 0.2265 - acc: 0.9778
Epoch 11/17
90/90 [==============================] - 0s - loss: 0.2059 - acc: 0.9889
Epoch 12/17
90/90 [==============================] - 0s - loss: 0.1889 - acc: 0.9778
Epoch 13/17
90/90 [==============================] - 0s - loss: 0.1747 - acc: 0.9889
Epoch 14/17
90/90 [==============================] - 0s - loss: 0.1616 - acc: 0.9889
Epoch 15/17
90/90 [==============================] - 0s - loss: 0.1518 - acc: 0.9889
Epoch 16/17
90/90 [==============================] - 0s - loss: 0.1443 - acc: 0.9889
Epoch 17/17
90/90 [==============================] - 0s - loss: 0.1338 - acc: 1.0000
('Test loss:', 0.50004416704177856)
('Test accuracy:', 0.75)
Testing ------------>
1500
Epoch 1/17
90/90 [==============================] - 0s - loss: 2.6243 - acc: 0.5778
Epoch 2/17
90/90 [==============================] - 0s - loss: 0.6524 - acc: 0.7667
Epoch 3/17
90/90 [==============================] - 0s - loss: 0.5959 - acc: 0.8222
Epoch 4/17
90/90 [==============================] - 0s - loss: 0.5428 - acc: 0.8556
Epoch 5/17
90/90 [==============================] - 0s - loss: 0.4889 - acc: 0.8667
Epoch 6/17
90/90 [==============================] - 0s - loss: 0.4493 - acc: 0.8889
Epoch 7/17
90/90 [==============================] - 0s - loss: 0.3737 - acc: 0.9444
Epoch 8/17
90/90 [==============================] - 0s - loss: 0.3739 - acc: 0.9111
Epoch 9/17
90/90 [==============================] - 0s - loss: 0.3576 - acc: 0.9111
Epoch 10/17
90/90 [==============================] - 0s - loss: 0.2978 - acc: 0.9667
Epoch 11/17
90/90 [==============================] - 0s - loss: 0.2496 - acc: 0.9778
Epoch 12/17
90/90 [==============================] - 0s - loss: 0.2313 - acc: 0.9667
Epoch 13/17
90/90 [==============================] - 0s - loss: 0.2158 - acc: 0.9778
Epoch 14/17
90/90 [==============================] - 0s - loss: 0.2003 - acc: 0.9889
Epoch 15/17
90/90 [==============================] - 0s - loss: 0.1824 - acc: 0.9778
Epoch 16/17
90/90 [==============================] - 0s - loss: 0.1690 - acc: 0.9889
Epoch 17/17
90/90 [==============================] - 0s - loss: 0.1540 - acc: 0.9889
('Test loss:', 0.25964128971099854)
('Test accuracy:', 0.91666668653488159)
Testing ------------>
1500
Epoch 1/17
90/90 [==============================] - 0s - loss: 2.6466 - acc: 0.6333
Epoch 2/17
90/90 [==============================] - 0s - loss: 0.6250 - acc: 0.8778
Epoch 3/17
90/90 [==============================] - 0s - loss: 0.5389 - acc: 0.9111
Epoch 4/17
90/90 [==============================] - 0s - loss: 0.4838 - acc: 0.8778
Epoch 5/17
90/90 [==============================] - 0s - loss: 0.4433 - acc: 0.9111
Epoch 6/17
90/90 [==============================] - 0s - loss: 0.3777 - acc: 0.9556
Epoch 7/17
90/90 [==============================] - 0s - loss: 0.3281 - acc: 0.9444
Epoch 8/17
90/90 [==============================] - 0s - loss: 0.2968 - acc: 0.9778
Epoch 9/17
90/90 [==============================] - 0s - loss: 0.2617 - acc: 0.9778
Epoch 10/17
90/90 [==============================] - 0s - loss: 0.2568 - acc: 0.9778
Epoch 11/17
90/90 [==============================] - 0s - loss: 0.2689 - acc: 0.9444
Epoch 12/17
90/90 [==============================] - 0s - loss: 0.2458 - acc: 0.9778
Epoch 13/17
90/90 [==============================] - 0s - loss: 0.2164 - acc: 0.9889
Epoch 14/17
90/90 [==============================] - 0s - loss: 0.1874 - acc: 0.9889
Epoch 15/17
90/90 [==============================] - 0s - loss: 0.1786 - acc: 0.9889
Epoch 16/17
90/90 [==============================] - 0s - loss: 0.1631 - acc: 0.9889
Epoch 17/17
90/90 [==============================] - 0s - loss: 0.1572 - acc: 1.0000
('Test loss:', 0.18867255747318268)
('Test accuracy:', 1.0)
Testing ------------>
1500
Epoch 1/17
90/90 [==============================] - 0s - loss: 2.5116 - acc: 0.7333
Epoch 2/17
90/90 [==============================] - 0s - loss: 0.6380 - acc: 0.8556
Epoch 3/17
90/90 [==============================] - 0s - loss: 0.5667 - acc: 0.8889
Epoch 4/17
90/90 [==============================] - 0s - loss: 0.4870 - acc: 0.8444
Epoch 5/17
90/90 [==============================] - 0s - loss: 0.4550 - acc: 0.9111
Epoch 6/17
90/90 [==============================] - 0s - loss: 0.3649 - acc: 0.9556
Epoch 7/17
90/90 [==============================] - 0s - loss: 0.3160 - acc: 0.9667
Epoch 8/17
90/90 [==============================] - 0s - loss: 0.3046 - acc: 0.9778
Epoch 9/17
90/90 [==============================] - 0s - loss: 0.2450 - acc: 0.9778
Epoch 10/17
90/90 [==============================] - 0s - loss: 0.2533 - acc: 0.9556
Epoch 11/17
90/90 [==============================] - 0s - loss: 0.2213 - acc: 0.9889
Epoch 12/17
90/90 [==============================] - 0s - loss: 0.1997 - acc: 1.0000
Epoch 13/17
90/90 [==============================] - 0s - loss: 0.1778 - acc: 0.9889
Epoch 14/17
90/90 [==============================] - 0s - loss: 0.1763 - acc: 1.0000
Epoch 15/17
90/90 [==============================] - 0s - loss: 0.1641 - acc: 0.9889
Epoch 16/17
90/90 [==============================] - 0s - loss: 0.1436 - acc: 1.0000
Epoch 17/17
90/90 [==============================] - 0s - loss: 0.1420 - acc: 1.0000
('Test loss:', 0.38593244552612305)
('Test accuracy:', 0.91666668653488159)
Testing ------------>
1500
Epoch 1/17
90/90 [==============================] - 0s - loss: 2.7468 - acc: 0.5444
Epoch 2/17
90/90 [==============================] - 0s - loss: 0.6739 - acc: 0.8222
Epoch 3/17
90/90 [==============================] - 0s - loss: 0.6169 - acc: 0.8444
Epoch 4/17
90/90 [==============================] - 0s - loss: 0.5589 - acc: 0.8667
Epoch 5/17
90/90 [==============================] - 0s - loss: 0.4926 - acc: 0.8667
Epoch 6/17
90/90 [==============================] - 0s - loss: 0.4335 - acc: 0.9111
Epoch 7/17
90/90 [==============================] - 0s - loss: 0.3860 - acc: 0.9000
Epoch 8/17
90/90 [==============================] - 0s - loss: 0.3492 - acc: 0.9333
Epoch 9/17
90/90 [==============================] - 0s - loss: 0.3214 - acc: 0.9333
Epoch 10/17
90/90 [==============================] - 0s - loss: 0.2826 - acc: 0.9667
Epoch 11/17
90/90 [==============================] - 0s - loss: 0.2508 - acc: 0.9778
Epoch 12/17
90/90 [==============================] - 0s - loss: 0.2243 - acc: 0.9778
Epoch 13/17
90/90 [==============================] - 0s - loss: 0.2054 - acc: 0.9889
Epoch 14/17
90/90 [==============================] - 0s - loss: 0.1928 - acc: 0.9889
Epoch 15/17
90/90 [==============================] - 0s - loss: 0.1695 - acc: 0.9889
Epoch 16/17
90/90 [==============================] - 0s - loss: 0.1568 - acc: 0.9889
Epoch 17/17
90/90 [==============================] - 0s - loss: 0.1493 - acc: 0.9889
('Test loss:', 0.29004287719726562)
('Test accuracy:', 0.91666668653488159)
Testing ------------>
1500
Epoch 1/17
90/90 [==============================] - 0s - loss: 3.3978 - acc: 0.7000
Epoch 2/17
90/90 [==============================] - 0s - loss: 0.6611 - acc: 0.7444
Epoch 3/17
90/90 [==============================] - 0s - loss: 0.5794 - acc: 0.8444
Epoch 4/17
90/90 [==============================] - 0s - loss: 0.5230 - acc: 0.8778
Epoch 5/17
90/90 [==============================] - 0s - loss: 0.4430 - acc: 0.9333
Epoch 6/17
90/90 [==============================] - 0s - loss: 0.3947 - acc: 0.9556
Epoch 7/17
90/90 [==============================] - 0s - loss: 0.3682 - acc: 0.9333
Epoch 8/17
90/90 [==============================] - 0s - loss: 0.3233 - acc: 0.9444
Epoch 9/17
90/90 [==============================] - 0s - loss: 0.2806 - acc: 0.9778
Epoch 10/17
90/90 [==============================] - 0s - loss: 0.2428 - acc: 0.9889
Epoch 11/17
90/90 [==============================] - 0s - loss: 0.2267 - acc: 0.9778
Epoch 12/17
90/90 [==============================] - 0s - loss: 0.2228 - acc: 0.9889
Epoch 13/17
90/90 [==============================] - 0s - loss: 0.2051 - acc: 0.9889
Epoch 14/17
90/90 [==============================] - 0s - loss: 0.1856 - acc: 0.9889
Epoch 15/17
90/90 [==============================] - 0s - loss: 0.1733 - acc: 0.9889
Epoch 16/17
90/90 [==============================] - 0s - loss: 0.1587 - acc: 0.9889
Epoch 17/17
90/90 [==============================] - 0s - loss: 0.1455 - acc: 0.9889
('Test loss:', 0.38305512070655823)
('Test accuracy:', 0.91666668653488159)
Testing ------------>
1500
Epoch 1/17
90/90 [==============================] - 0s - loss: 3.1135 - acc: 0.6556
Epoch 2/17
90/90 [==============================] - 0s - loss: 0.6433 - acc: 0.7111
Epoch 3/17
90/90 [==============================] - 0s - loss: 0.5936 - acc: 0.7444
Epoch 4/17
90/90 [==============================] - 0s - loss: 0.5416 - acc: 0.8333
Epoch 5/17
90/90 [==============================] - 0s - loss: 0.4613 - acc: 0.9222
Epoch 6/17
90/90 [==============================] - 0s - loss: 0.4237 - acc: 0.8889
Epoch 7/17
90/90 [==============================] - 0s - loss: 0.3922 - acc: 0.9111
Epoch 8/17
90/90 [==============================] - 0s - loss: 0.3324 - acc: 0.9556
Epoch 9/17
90/90 [==============================] - 0s - loss: 0.3246 - acc: 0.9333
Epoch 10/17
90/90 [==============================] - 0s - loss: 0.2945 - acc: 0.9667
Epoch 11/17
90/90 [==============================] - 0s - loss: 0.2776 - acc: 0.9667
Epoch 12/17
90/90 [==============================] - 0s - loss: 0.2443 - acc: 0.9778
Epoch 13/17
90/90 [==============================] - 0s - loss: 0.2318 - acc: 0.9778
Epoch 14/17
90/90 [==============================] - 0s - loss: 0.2077 - acc: 0.9889
Epoch 15/17
90/90 [==============================] - 0s - loss: 0.1910 - acc: 0.9889
Epoch 16/17
90/90 [==============================] - 0s - loss: 0.1793 - acc: 0.9889
Epoch 17/17
90/90 [==============================] - 0s - loss: 0.1781 - acc: 0.9778
('Test loss:', 0.14115214347839355)
('Test accuracy:', 1.0)
Testing ------------>
1500
Epoch 1/17
90/90 [==============================] - 0s - loss: 3.0701 - acc: 0.4556
Epoch 2/17
90/90 [==============================] - 0s - loss: 0.7022 - acc: 0.7333
Epoch 3/17
90/90 [==============================] - 0s - loss: 0.6603 - acc: 0.7222
Epoch 4/17
90/90 [==============================] - 0s - loss: 0.6016 - acc: 0.7889
Epoch 5/17
90/90 [==============================] - 0s - loss: 0.5301 - acc: 0.9111
Epoch 6/17
90/90 [==============================] - 0s - loss: 0.4606 - acc: 0.9333
Epoch 7/17
90/90 [==============================] - 0s - loss: 0.4127 - acc: 0.8889
Epoch 8/17
90/90 [==============================] - 0s - loss: 0.3627 - acc: 0.9556
Epoch 9/17
90/90 [==============================] - 0s - loss: 0.3195 - acc: 0.9778
Epoch 10/17
90/90 [==============================] - 0s - loss: 0.2930 - acc: 0.9778
Epoch 11/17
90/90 [==============================] - 0s - loss: 0.2780 - acc: 0.9667
Epoch 12/17
90/90 [==============================] - 0s - loss: 0.2541 - acc: 0.9778
Epoch 13/17
90/90 [==============================] - 0s - loss: 0.2302 - acc: 0.9889
Epoch 14/17
90/90 [==============================] - 0s - loss: 0.2167 - acc: 0.9778
Epoch 15/17
90/90 [==============================] - 0s - loss: 0.2038 - acc: 0.9889
Epoch 16/17
90/90 [==============================] - 0s - loss: 0.1805 - acc: 0.9889
Epoch 17/17
90/90 [==============================] - 0s - loss: 0.1695 - acc: 0.9889
('Test loss:', 0.28919500112533569)
('Test accuracy:', 0.83333331346511841)
Testing ------------>
1500
Epoch 1/17
90/90 [==============================] - 0s - loss: 2.8746 - acc: 0.6556
Epoch 2/17
90/90 [==============================] - 0s - loss: 0.6741 - acc: 0.7222
Epoch 3/17
90/90 [==============================] - 0s - loss: 0.5986 - acc: 0.8778
Epoch 4/17
90/90 [==============================] - 0s - loss: 0.5041 - acc: 0.9111
Epoch 5/17
90/90 [==============================] - 0s - loss: 0.4338 - acc: 0.9333
Epoch 6/17
90/90 [==============================] - 0s - loss: 0.4267 - acc: 0.8667
Epoch 7/17
90/90 [==============================] - 0s - loss: 0.3867 - acc: 0.9222
Epoch 8/17
90/90 [==============================] - 0s - loss: 0.3162 - acc: 0.9667
Epoch 9/17
90/90 [==============================] - 0s - loss: 0.2862 - acc: 0.9556
Epoch 10/17
90/90 [==============================] - 0s - loss: 0.2691 - acc: 0.9778
Epoch 11/17
90/90 [==============================] - 0s - loss: 0.2378 - acc: 0.9778
Epoch 12/17
90/90 [==============================] - 0s - loss: 0.2639 - acc: 0.9667
Epoch 13/17
90/90 [==============================] - 0s - loss: 0.2358 - acc: 0.9889
Epoch 14/17
90/90 [==============================] - 0s - loss: 0.1984 - acc: 0.9889
Epoch 15/17
90/90 [==============================] - 0s - loss: 0.1758 - acc: 1.0000
Epoch 16/17
90/90 [==============================] - 0s - loss: 0.1565 - acc: 1.0000
Epoch 17/17
90/90 [==============================] - 0s - loss: 0.1448 - acc: 1.0000
('Test loss:', 0.161852166056633)
('Test accuracy:', 1.0)
9.2500000596



l1 weight
Testing ------------>
Using TensorFlow backend.
1500
tenflod.py:66: UserWarning: Update your `Dense` call to the Keras 2 API: `Dense(2000, activation="linear", kernel_regularizer=<keras.reg..., input_shape=(1500,))`
  model.add(Dense(2000, activation='linear',W_regularizer = l1(0.0001),input_shape=(1500,)))
tenflod.py:69: UserWarning: Update your `Dense` call to the Keras 2 API: `Dense(1000, activation="linear", kernel_regularizer=<keras.reg...)`
  model.add(Dense(1000, activation='linear',W_regularizer = l1(0.001)))
Epoch 1/17
2017-11-16 03:19:13.105991: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-16 03:19:13.106051: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2017-11-16 03:19:13.106069: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
90/90 [==============================] - 1s - loss: 51.5249 - acc: 0.5111
Epoch 2/17
90/90 [==============================] - 0s - loss: 45.2524 - acc: 0.6000
Epoch 3/17
90/90 [==============================] - 0s - loss: 40.6075 - acc: 0.7444
Epoch 4/17
90/90 [==============================] - 0s - loss: 36.2615 - acc: 0.8111
Epoch 5/17
90/90 [==============================] - 0s - loss: 32.2402 - acc: 0.8556
Epoch 6/17
90/90 [==============================] - 0s - loss: 28.5221 - acc: 0.9000
Epoch 7/17
90/90 [==============================] - 0s - loss: 25.1791 - acc: 0.8778
Epoch 8/17
90/90 [==============================] - 0s - loss: 21.9786 - acc: 0.9000
Epoch 9/17
90/90 [==============================] - 0s - loss: 19.2434 - acc: 0.8556
Epoch 10/17
90/90 [==============================] - 0s - loss: 16.7203 - acc: 0.9444
Epoch 11/17
90/90 [==============================] - 0s - loss: 14.5623 - acc: 0.9222
Epoch 12/17
90/90 [==============================] - 0s - loss: 12.6979 - acc: 0.9556
Epoch 13/17
90/90 [==============================] - 0s - loss: 11.1706 - acc: 0.9667
Epoch 14/17
90/90 [==============================] - 0s - loss: 9.9695 - acc: 0.9778
Epoch 15/17
90/90 [==============================] - 0s - loss: 9.1295 - acc: 0.9667
Epoch 16/17
90/90 [==============================] - 0s - loss: 8.4990 - acc: 0.9778
Epoch 17/17
90/90 [==============================] - 0s - loss: 7.9104 - acc: 0.9778
('Test loss:', 7.3974971771240234)
('Test accuracy:', 1.0)
Testing ------------>
1500
Epoch 1/17
90/90 [==============================] - 1s - loss: 51.1164 - acc: 0.5889
Epoch 2/17
90/90 [==============================] - 0s - loss: 45.7825 - acc: 0.5889
Epoch 3/17
90/90 [==============================] - 0s - loss: 40.9760 - acc: 0.7444
Epoch 4/17
90/90 [==============================] - 0s - loss: 36.7874 - acc: 0.6889
Epoch 5/17
90/90 [==============================] - 0s - loss: 32.8282 - acc: 0.7778
Epoch 6/17
90/90 [==============================] - 0s - loss: 29.0756 - acc: 0.8778
Epoch 7/17
90/90 [==============================] - 0s - loss: 25.6610 - acc: 0.9111
Epoch 8/17
90/90 [==============================] - 0s - loss: 22.5223 - acc: 0.9222
Epoch 9/17
90/90 [==============================] - 0s - loss: 19.6715 - acc: 0.9333
Epoch 10/17
90/90 [==============================] - 0s - loss: 17.1669 - acc: 0.9444
Epoch 11/17
90/90 [==============================] - 0s - loss: 14.9356 - acc: 0.9444
Epoch 12/17
90/90 [==============================] - 0s - loss: 13.0173 - acc: 0.9556
Epoch 13/17
90/90 [==============================] - 0s - loss: 11.4922 - acc: 0.9444
Epoch 14/17
90/90 [==============================] - 0s - loss: 10.1877 - acc: 0.9667
Epoch 15/17
90/90 [==============================] - 0s - loss: 9.2378 - acc: 0.9778
Epoch 16/17
90/90 [==============================] - 0s - loss: 8.5680 - acc: 0.9778
Epoch 17/17
90/90 [==============================] - 0s - loss: 7.8991 - acc: 0.9778
('Test loss:', 8.2302255630493164)
('Test accuracy:', 0.83333331346511841)
Testing ------------>
1500
Epoch 1/17
90/90 [==============================] - 1s - loss: 51.2392 - acc: 0.4778
Epoch 2/17
90/90 [==============================] - 0s - loss: 46.0512 - acc: 0.4889
Epoch 3/17
90/90 [==============================] - 0s - loss: 40.6061 - acc: 0.5667
Epoch 4/17
90/90 [==============================] - 0s - loss: 36.2064 - acc: 0.7333
Epoch 5/17
90/90 [==============================] - 0s - loss: 32.0470 - acc: 0.8444
Epoch 6/17
90/90 [==============================] - 0s - loss: 28.2639 - acc: 0.8333
Epoch 7/17
90/90 [==============================] - 0s - loss: 24.7562 - acc: 0.8778
Epoch 8/17
90/90 [==============================] - 0s - loss: 21.6183 - acc: 0.8556
Epoch 9/17
90/90 [==============================] - 0s - loss: 18.7798 - acc: 0.8333
Epoch 10/17
90/90 [==============================] - 0s - loss: 16.1814 - acc: 0.9000
Epoch 11/17
90/90 [==============================] - 0s - loss: 13.9581 - acc: 0.9333
Epoch 12/17
90/90 [==============================] - 0s - loss: 12.0760 - acc: 0.9333
Epoch 13/17
90/90 [==============================] - 0s - loss: 10.4849 - acc: 0.9333
Epoch 14/17
90/90 [==============================] - 0s - loss: 9.2693 - acc: 0.9667
Epoch 15/17
90/90 [==============================] - 0s - loss: 8.3903 - acc: 0.9444
Epoch 16/17
90/90 [==============================] - 0s - loss: 7.7897 - acc: 0.9667
Epoch 17/17
90/90 [==============================] - 0s - loss: 7.1717 - acc: 0.9667
('Test loss:', 6.9913411140441895)
('Test accuracy:', 0.83333331346511841)
Testing ------------>
1500
Epoch 1/17
90/90 [==============================] - 1s - loss: 50.9995 - acc: 0.5889
Epoch 2/17
90/90 [==============================] - 0s - loss: 45.9404 - acc: 0.4444
Epoch 3/17
90/90 [==============================] - 0s - loss: 40.8561 - acc: 0.6111
Epoch 4/17
90/90 [==============================] - 0s - loss: 36.5276 - acc: 0.7556
Epoch 5/17
90/90 [==============================] - 0s - loss: 32.6176 - acc: 0.8000
Epoch 6/17
90/90 [==============================] - 0s - loss: 28.8842 - acc: 0.8444
Epoch 7/17
90/90 [==============================] - 0s - loss: 25.4330 - acc: 0.9111
Epoch 8/17
90/90 [==============================] - 0s - loss: 22.3249 - acc: 0.9444
Epoch 9/17
90/90 [==============================] - 0s - loss: 19.5001 - acc: 0.9111
Epoch 10/17
90/90 [==============================] - 0s - loss: 16.9851 - acc: 0.9333
Epoch 11/17
90/90 [==============================] - 0s - loss: 14.8071 - acc: 0.8889
Epoch 12/17
90/90 [==============================] - 0s - loss: 12.9136 - acc: 0.9111
Epoch 13/17
90/90 [==============================] - 0s - loss: 11.3269 - acc: 0.9333
Epoch 14/17
90/90 [==============================] - 0s - loss: 10.0947 - acc: 0.9444
Epoch 15/17
90/90 [==============================] - 0s - loss: 9.1685 - acc: 0.9556
Epoch 16/17
90/90 [==============================] - 0s - loss: 8.4881 - acc: 0.9778
Epoch 17/17
90/90 [==============================] - 0s - loss: 7.8473 - acc: 0.9556
('Test loss:', 7.3752255439758301)
('Test accuracy:', 1.0)
Testing ------------>
1500
Epoch 1/17
90/90 [==============================] - 1s - loss: 50.5927 - acc: 0.5444
Epoch 2/17
90/90 [==============================] - 0s - loss: 45.2964 - acc: 0.6778
Epoch 3/17
90/90 [==============================] - 0s - loss: 40.3832 - acc: 0.7778
Epoch 4/17
90/90 [==============================] - 0s - loss: 36.1395 - acc: 0.7778
Epoch 5/17
90/90 [==============================] - 0s - loss: 32.1500 - acc: 0.8778
Epoch 6/17
90/90 [==============================] - 0s - loss: 28.4916 - acc: 0.8778
Epoch 7/17
90/90 [==============================] - 0s - loss: 25.1147 - acc: 0.9111
Epoch 8/17
90/90 [==============================] - 0s - loss: 22.0311 - acc: 0.9000
Epoch 9/17
90/90 [==============================] - 0s - loss: 19.2125 - acc: 0.9333
Epoch 10/17
90/90 [==============================] - 0s - loss: 16.7414 - acc: 0.9333
Epoch 11/17
90/90 [==============================] - 0s - loss: 14.5559 - acc: 0.9444
Epoch 12/17
90/90 [==============================] - 0s - loss: 12.6887 - acc: 0.9667
Epoch 13/17
90/90 [==============================] - 0s - loss: 11.1481 - acc: 0.9667
Epoch 14/17
90/90 [==============================] - 0s - loss: 9.9178 - acc: 0.9667
Epoch 15/17
90/90 [==============================] - 0s - loss: 9.0274 - acc: 0.9667
Epoch 16/17
90/90 [==============================] - 0s - loss: 8.4013 - acc: 0.9778
Epoch 17/17
90/90 [==============================] - 0s - loss: 7.7597 - acc: 0.9778
('Test loss:', 7.3658738136291504)
('Test accuracy:', 1.0)
Testing ------------>
1500
Epoch 1/17
90/90 [==============================] - 1s - loss: 50.8443 - acc: 0.5556
Epoch 2/17
90/90 [==============================] - 0s - loss: 45.4636 - acc: 0.6444
Epoch 3/17
90/90 [==============================] - 0s - loss: 40.6249 - acc: 0.6889
Epoch 4/17
90/90 [==============================] - 0s - loss: 36.3113 - acc: 0.7778
Epoch 5/17
90/90 [==============================] - 0s - loss: 32.4009 - acc: 0.8000
Epoch 6/17
90/90 [==============================] - 0s - loss: 28.7404 - acc: 0.8111
Epoch 7/17
90/90 [==============================] - 0s - loss: 25.2574 - acc: 0.8778
Epoch 8/17
90/90 [==============================] - 0s - loss: 22.1621 - acc: 0.9000
Epoch 9/17
90/90 [==============================] - 0s - loss: 19.3794 - acc: 0.9222
Epoch 10/17
90/90 [==============================] - 0s - loss: 16.8818 - acc: 0.9222
Epoch 11/17
90/90 [==============================] - 0s - loss: 14.6908 - acc: 0.9333
Epoch 12/17
90/90 [==============================] - 0s - loss: 12.7979 - acc: 0.9667
Epoch 13/17
90/90 [==============================] - 0s - loss: 11.2564 - acc: 0.9667
Epoch 14/17
90/90 [==============================] - 0s - loss: 10.0322 - acc: 0.9556
Epoch 15/17
90/90 [==============================] - 0s - loss: 9.1268 - acc: 0.9556
Epoch 16/17
90/90 [==============================] - 0s - loss: 8.5041 - acc: 0.9778
Epoch 17/17
90/90 [==============================] - 0s - loss: 7.8594 - acc: 0.9778
('Test loss:', 7.5778465270996094)
('Test accuracy:', 0.91666668653488159)
Testing ------------>
1500
Epoch 1/17
90/90 [==============================] - 1s - loss: 52.5131 - acc: 0.4556
Epoch 2/17
90/90 [==============================] - 0s - loss: 45.8862 - acc: 0.4889
Epoch 3/17
90/90 [==============================] - 0s - loss: 41.3640 - acc: 0.5556
Epoch 4/17
90/90 [==============================] - 0s - loss: 36.9123 - acc: 0.7222
Epoch 5/17
90/90 [==============================] - 0s - loss: 32.8609 - acc: 0.7000
Epoch 6/17
90/90 [==============================] - 0s - loss: 29.1533 - acc: 0.7222
Epoch 7/17
90/90 [==============================] - 0s - loss: 25.7169 - acc: 0.8333
Epoch 8/17
90/90 [==============================] - 0s - loss: 22.5209 - acc: 0.8556
Epoch 9/17
90/90 [==============================] - 0s - loss: 19.6730 - acc: 0.7889
Epoch 10/17
90/90 [==============================] - 0s - loss: 17.1124 - acc: 0.9111
Epoch 11/17
90/90 [==============================] - 0s - loss: 14.8219 - acc: 0.9222
Epoch 12/17
90/90 [==============================] - 0s - loss: 12.8752 - acc: 0.9222
Epoch 13/17
90/90 [==============================] - 0s - loss: 11.2833 - acc: 0.9444
Epoch 14/17
90/90 [==============================] - 0s - loss: 10.0121 - acc: 0.9556
Epoch 15/17
90/90 [==============================] - 0s - loss: 9.0744 - acc: 0.9667
Epoch 16/17
90/90 [==============================] - 0s - loss: 8.3959 - acc: 0.9778
Epoch 17/17
90/90 [==============================] - 0s - loss: 7.7255 - acc: 0.9889
('Test loss:', 7.5275788307189941)
('Test accuracy:', 0.83333331346511841)
Testing ------------>
1500
Epoch 1/17
90/90 [==============================] - 1s - loss: 51.5817 - acc: 0.4333
Epoch 2/17
90/90 [==============================] - 0s - loss: 45.6205 - acc: 0.5889
Epoch 3/17
90/90 [==============================] - 0s - loss: 41.0468 - acc: 0.7222
Epoch 4/17
90/90 [==============================] - 0s - loss: 36.9138 - acc: 0.8111
Epoch 5/17
90/90 [==============================] - 0s - loss: 33.1316 - acc: 0.6667
Epoch 6/17
90/90 [==============================] - 0s - loss: 29.4520 - acc: 0.8222
Epoch 7/17
90/90 [==============================] - 0s - loss: 26.0977 - acc: 0.8333
Epoch 8/17
90/90 [==============================] - 0s - loss: 23.0320 - acc: 0.8444
Epoch 9/17
90/90 [==============================] - 0s - loss: 20.2395 - acc: 0.8889
Epoch 10/17
90/90 [==============================] - 0s - loss: 17.7442 - acc: 0.9222
Epoch 11/17
90/90 [==============================] - 0s - loss: 15.5718 - acc: 0.9333
Epoch 12/17
90/90 [==============================] - 0s - loss: 13.6991 - acc: 0.9222
Epoch 13/17
90/90 [==============================] - 0s - loss: 12.1247 - acc: 0.9444
Epoch 14/17
90/90 [==============================] - 0s - loss: 10.8714 - acc: 0.9667
Epoch 15/17
90/90 [==============================] - 0s - loss: 9.9378 - acc: 0.9667
Epoch 16/17
90/90 [==============================] - 0s - loss: 9.2558 - acc: 0.9778
Epoch 17/17
90/90 [==============================] - 0s - loss: 8.5979 - acc: 0.9667
('Test loss:', 8.0864381790161133)
('Test accuracy:', 1.0)
Testing ------------>
1500
Epoch 1/17
90/90 [==============================] - 1s - loss: 50.9883 - acc: 0.4667
Epoch 2/17
90/90 [==============================] - 0s - loss: 45.5346 - acc: 0.7000
Epoch 3/17
90/90 [==============================] - 0s - loss: 41.3894 - acc: 0.5111
Epoch 4/17
90/90 [==============================] - 0s - loss: 36.8172 - acc: 0.7222
Epoch 5/17
90/90 [==============================] - 0s - loss: 32.7410 - acc: 0.7556
Epoch 6/17
90/90 [==============================] - 0s - loss: 29.0316 - acc: 0.6556
Epoch 7/17
90/90 [==============================] - 0s - loss: 25.6269 - acc: 0.8111
Epoch 8/17
90/90 [==============================] - 0s - loss: 22.5877 - acc: 0.8111
Epoch 9/17
90/90 [==============================] - 0s - loss: 19.7838 - acc: 0.9111
Epoch 10/17
90/90 [==============================] - 0s - loss: 17.2929 - acc: 0.9222
Epoch 11/17
90/90 [==============================] - 0s - loss: 15.1151 - acc: 0.9333
Epoch 12/17
90/90 [==============================] - 0s - loss: 13.2733 - acc: 0.9333
Epoch 13/17
90/90 [==============================] - 0s - loss: 11.7555 - acc: 0.9333
Epoch 14/17
90/90 [==============================] - 0s - loss: 10.5709 - acc: 0.9556
Epoch 15/17
90/90 [==============================] - 0s - loss: 9.7113 - acc: 0.9556
Epoch 16/17
90/90 [==============================] - 0s - loss: 9.0976 - acc: 0.9556
Epoch 17/17
90/90 [==============================] - 0s - loss: 8.4765 - acc: 0.9444
('Test loss:', 8.0919399261474609)
('Test accuracy:', 0.91666668653488159)
Testing ------------>
1500
Epoch 1/17
90/90 [==============================] - 1s - loss: 50.6219 - acc: 0.4667
Epoch 2/17
90/90 [==============================] - 0s - loss: 46.3293 - acc: 0.5444
Epoch 3/17
90/90 [==============================] - 0s - loss: 40.8677 - acc: 0.5778
Epoch 4/17
90/90 [==============================] - 0s - loss: 36.7145 - acc: 0.7444
Epoch 5/17
90/90 [==============================] - 0s - loss: 32.5920 - acc: 0.8222
Epoch 6/17
90/90 [==============================] - 0s - loss: 29.0009 - acc: 0.7444
Epoch 7/17
90/90 [==============================] - 0s - loss: 25.5570 - acc: 0.8222
Epoch 8/17
90/90 [==============================] - 0s - loss: 22.4194 - acc: 0.9111
Epoch 9/17
90/90 [==============================] - 0s - loss: 19.6334 - acc: 0.9111
Epoch 10/17
90/90 [==============================] - 0s - loss: 17.1154 - acc: 0.9000
Epoch 11/17
90/90 [==============================] - 0s - loss: 14.9270 - acc: 0.9333
Epoch 12/17
90/90 [==============================] - 0s - loss: 13.0501 - acc: 0.9444
Epoch 13/17
90/90 [==============================] - 0s - loss: 11.4994 - acc: 0.9556
Epoch 14/17
90/90 [==============================] - 0s - loss: 10.2702 - acc: 0.9667
Epoch 15/17
90/90 [==============================] - 0s - loss: 9.3636 - acc: 0.9667
Epoch 16/17
90/90 [==============================] - 0s - loss: 8.7301 - acc: 0.9778
Epoch 17/17
90/90 [==============================] - 0s - loss: 8.1039 - acc: 0.9778
('Test loss:', 7.6287460327148438)
('Test accuracy:', 1.0)
9.33333331347

9.16666674614

'''

